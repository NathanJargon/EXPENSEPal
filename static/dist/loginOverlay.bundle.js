document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("expense-form"),t=document.getElementById("login-button"),n=document.getElementById("loginOverlay"),a=document.getElementById("email"),o=document.getElementById("password"),r=document.getElementById("loginLogoutLink"),i=document.getElementById("userName");e&&e.addEventListener("submit",(function(e){e.preventDefault();var t=document.querySelector('input[name="description"]').value,n=document.querySelector('input[name="amount"]').value,a=document.querySelector('input[name="date"]').value,o=document.querySelector('input[name="category"]').value;firebase.auth().onAuthStateChanged((function(e){e&&e.getIdToken().then((function(r){var i=r;document.cookie="your_firebase_cookie_name="+i;var u={description:t,amount:n,date:a,category:o,idToken:i,email:e.email};fetch("/add_expense",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i},body:JSON.stringify(u)}).then((function(e){200===e.status?fetchAndUpdateExpenses():console.error("Failed to add expense:",e.status)})).catch((function(e){console.error("Error adding expense:",e)}))})).catch((function(e){console.error("Error getting ID token:",e)}))}))})),t&&t.addEventListener("click",(function(){var e=a.value,t=o.value;firebase.auth().onAuthStateChanged((function(e){if(e){if(e.getIdToken().then((function(t){var n=t;document.cookie="your_firebase_cookie_name="+n,e.uid})),e.email){var t=e.email.split("@")[0].slice(0,5).toUpperCase();r.textContent="Logout",i.textContent=t,localStorage.setItem("userName",t)}n.style.display="none"}})),firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then((function(){return firebase.auth().signInWithEmailAndPassword(e,t)})).then((function(e){e.user,n.style.display="none"})).catch((function(e){var t=e.code;e.message,"auth/wrong-password"===t?(alert("Wrong password."),o.style.animation="turnRed 1s, shake 0.5s"):"auth/internal-error"===t?(alert("Internal Error."),o.style.animation="turnRed 1s, shake 0.5s"):"auth/user-not-found"===t?(alert("User not found."),a.style.animation="turnRed 1s, shake 0.5s"):"auth/invalid-email"===t&&(alert("Invalid email."),a.style.animation="turnRed 1s, shake 0.5s")}))}))}));